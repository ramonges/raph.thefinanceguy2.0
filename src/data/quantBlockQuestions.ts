import { MathQuestion, ProbaQuestion, TradingQuestion, BehavioralQuestion, MLQuestion } from '@/types'

export const quantBlockQuestions = {
  'mental-calculations': [
    {
      id: 1,
      question: "Calculate ln(e³) + ln(e²)",
      answer: "5 (ln(e³) + ln(e²) = 3 + 2 = 5)",
      hint: "Use the property: ln(a) + ln(b) = ln(ab), and ln(eⁿ) = n",
      difficulty: "easy",
      targetTime: 30,
    },
    {
      id: 2,
      question: "What's the integral of x² from 0 to 3?",
      answer: "9 (∫₀³ x² dx = [x³/3]₀³ = 27/3 - 0 = 9)",
      hint: "Use the power rule: ∫xⁿ dx = xⁿ⁺¹/(n+1)",
      difficulty: "easy",
      targetTime: 45,
    },
    {
      id: 3,
      question: "Calculate e^(ln(5))",
      answer: "5 (e^(ln(5)) = 5, since e and ln are inverse functions)",
      hint: "e and ln are inverse functions: e^(ln(x)) = x",
      difficulty: "easy",
      targetTime: 20,
    },
    {
      id: 4,
      question: "What's the derivative of x³ - 2x² + 5x?",
      answer: "3x² - 4x + 5 (d/dx(x³ - 2x² + 5x) = 3x² - 4x + 5)",
      hint: "Use the power rule: d/dx(xⁿ) = nxⁿ⁻¹",
      difficulty: "easy",
      targetTime: 30,
    },
    {
      id: 5,
      question: "Solve: 2^x = 32",
      answer: "x = 5 (2⁵ = 32)",
      hint: "Express 32 as a power of 2",
      difficulty: "easy",
      targetTime: 30,
    },
  ] as MathQuestion[],
  'probability-exercises': [
    {
      id: 1,
      question: "A stock's log returns are normally distributed with μ=0.001 and σ=0.02 daily. What's the probability of a positive return tomorrow?",
      answer: "Approximately 0.52 or 52% (P(X > 0) where X ~ N(0.001, 0.02²). Z = (0 - 0.001)/0.02 = -0.05, so P(Z > -0.05) ≈ 0.52)",
      explanation: [
        "Log returns: X ~ N(0.001, 0.02²)",
        "P(X > 0) = P((X - μ)/σ > (0 - 0.001)/0.02)",
        "Z = -0.05, P(Z > -0.05) ≈ 0.52",
        "Since mean is slightly positive, probability > 50%",
      ],
      hint: "Standardize to Z-score and use normal distribution",
      difficulty: "medium",
      targetTime: 60,
    },
    {
      id: 2,
      question: "You have three biased coins: p(H) = 0.3, 0.5, 0.7. You pick one randomly and flip heads. What's the probability it was the 0.7 coin?",
      answer: "7/15 ≈ 0.467 (Using Bayes' theorem: P(0.7 coin | H) = (1/3 × 0.7) / ((1/3)(0.3 + 0.5 + 0.7)) = 0.7/1.5 = 7/15)",
      explanation: [
        "Use Bayes' theorem: P(coin | H) = P(H | coin) × P(coin) / P(H)",
        "P(H) = (1/3)(0.3 + 0.5 + 0.7) = 1.5/3 = 0.5",
        "P(0.7 coin | H) = (1/3 × 0.7) / 0.5 = 0.7/1.5 = 7/15",
        "Higher probability coin is more likely given heads observed",
      ],
      hint: "Use Bayes' theorem with prior probabilities",
      difficulty: "medium",
      targetTime: 75,
    },
    {
      id: 3,
      question: "Stock returns follow a random walk. After n steps with equal probability ±σ, what's the variance of position?",
      answer: "nσ² (Each step has variance σ², and variance of sum of independent steps = sum of variances)",
      explanation: [
        "Random walk: X_n = X₀ + Σᵢ εᵢ where εᵢ = ±σ with equal probability",
        "E[εᵢ] = 0, Var(εᵢ) = σ²",
        "Var(X_n) = Var(Σᵢ εᵢ) = Σᵢ Var(εᵢ) = nσ²",
        "Variance grows linearly with number of steps",
      ],
      hint: "Variance of sum of independent random variables",
      difficulty: "medium",
      targetTime: 60,
    },
    {
      id: 4,
      question: "Two independent stocks each have 60% probability of going up. What's the probability both go up?",
      answer: "0.36 or 36% (0.6 × 0.6 = 0.36, since they're independent)",
      explanation: [
        "P(both up) = P(stock 1 up) × P(stock 2 up)",
        "Since independent: P(both up) = 0.6 × 0.6 = 0.36",
        "For independent events, multiply probabilities",
      ],
      hint: "For independent events, multiply probabilities",
      difficulty: "easy",
      targetTime: 30,
    },
    {
      id: 5,
      question: "A trading signal has 70% accuracy. You observe 3 consecutive correct predictions. What's the posterior probability the signal is actually good (vs random)?",
      answer: "Depends on prior, but if prior P(good) = 0.5, then posterior ≈ 0.93 (Using Bayes: P(good | 3 correct) = (0.5 × 0.7³) / (0.5 × 0.7³ + 0.5 × 0.5³) ≈ 0.93)",
      explanation: [
        "Bayes' theorem: P(good | 3 correct) = P(3 correct | good) × P(good) / P(3 correct)",
        "P(3 correct | good) = 0.7³ = 0.343",
        "P(3 correct | random) = 0.5³ = 0.125",
        "If prior P(good) = 0.5: P(good | 3 correct) = 0.343 / (0.343 + 0.125) ≈ 0.73",
        "Actually recalc: (0.5 × 0.343) / (0.5 × 0.343 + 0.5 × 0.125) = 0.1715 / 0.234 ≈ 0.73",
      ],
      hint: "Use Bayes' theorem with prior probability",
      difficulty: "hard",
      targetTime: 90,
    },
  ] as ProbaQuestion[],
  'brainteasers': [
    {
      id: 1,
      question: "You have 25 horses and can race 5 at a time. What's the minimum number of races to find the top 3 fastest horses?",
      answer: "7 races (5 races to race all 25, then race the 5 winners to find fastest, then race 2nd/3rd from winner's race + 2nd/3rd from overall + 2nd from 2nd place's race)",
      explanation: [
        "Race 1-5: Race all 25 horses (5 races)",
        "Race 6: Race the 5 winners → find fastest overall",
        "Race 7: Race 2nd/3rd from fastest's race + 2nd from overall 2nd place's race + 3rd from fastest's race if needed",
        "Actually: 2nd/3rd from fastest's race, 2nd from 2nd place's race, 3rd from fastest's race",
        "Minimum is 7 races",
      ],
      hint: "Think about elimination and which horses can still be in top 3",
      difficulty: "hard",
      targetTime: 120,
    },
    {
      id: 2,
      question: "A cube is painted red on all sides then cut into 27 smaller cubes. How many small cubes have exactly 2 red faces?",
      answer: "12 cubes (The cubes on the edges but not corners: 12 edges × 1 cube per edge = 12)",
      explanation: [
        "3×3×3 cube has 27 smaller cubes",
        "Cubes with 2 faces: those on edges but not corners",
        "A cube has 12 edges",
        "Each edge has 1 cube (middle of edge) with exactly 2 painted faces",
        "Total: 12 cubes",
      ],
      hint: "Think about which cubes are on edges but not corners",
      difficulty: "medium",
      targetTime: 60,
    },
    {
      id: 3,
      question: "You're in a corridor with 100 doors, all closed. You toggle door n on your nth pass (pass 1: all doors, pass 2: every 2nd door, etc.). Which doors are open after 100 passes?",
      answer: "Perfect squares: 1, 4, 9, 16, 25, 36, 49, 64, 81, 100 (Doors with odd number of divisors, which are perfect squares)",
      explanation: [
        "Door n is toggled on passes that divide n",
        "Door ends open if toggled odd number of times",
        "Odd number of toggles = odd number of divisors",
        "Only perfect squares have odd number of divisors",
        "Perfect squares from 1 to 100: 1, 4, 9, 16, 25, 36, 49, 64, 81, 100",
      ],
      hint: "Think about which doors are toggled an odd number of times",
      difficulty: "hard",
      targetTime: 90,
    },
    {
      id: 4,
      question: "A clock shows 3:15. What's the exact angle between the hour and minute hands?",
      answer: "7.5° (At 3:15, hour hand is at 3.25 × 30° = 97.5°, minute hand at 90°, difference = 7.5°)",
      explanation: [
        "Minute hand at 15 minutes: 15/60 × 360° = 90°",
        "Hour hand: at 3:00 it's at 90°, moves 15/60 × 30° = 7.5° more",
        "Hour hand position: 90° + 7.5° = 97.5°",
        "Difference: 97.5° - 90° = 7.5°",
      ],
      hint: "Hour hand moves 30° per hour, 0.5° per minute",
      difficulty: "medium",
      targetTime: 45,
    },
    {
      id: 5,
      question: "You have 9 balls, one is lighter. Find it in 2 weighings with a balance scale. Can you also determine if it's lighter or heavier?",
      answer: "Yes. Weigh 3 vs 3. If equal, the lighter is in remaining 3, weigh 1 vs 1. If unequal, lighter is in lighter group of 3, weigh 1 vs 1 from that group.",
      explanation: [
        "Weighing 1: Put 3 balls on each side",
        "If equal: lighter is in remaining 3, weigh 1 vs 1 (if equal, the remaining is lighter)",
        "If unequal: lighter is in the lighter group of 3",
        "Weighing 2: From the lighter group, weigh 1 vs 1 (lighter one is the light ball, or if equal, the remaining is lighter)",
        "Can determine it's lighter (not heavier) since we know one is lighter",
      ],
      hint: "Divide into groups of 3",
      difficulty: "medium",
      targetTime: 90,
    },
  ] as ProbaQuestion[],
  'coding-project': [
    {
      id: 1,
      prompt: "Moving Average Crossover: Implement a function that takes price data and returns buy/sell signals when a short MA crosses a long MA.",
      tags: ["Coding", "Technical Analysis", "Python"],
      starChecks: [
        "Function signature and input validation",
        "Correct calculation of moving averages",
        "Proper detection of crossover points",
        "Clear return format for signals",
      ],
    },
    {
      id: 2,
      prompt: "Bollinger Bands: Write a function to calculate Bollinger Bands (mean ± 2 std dev) for a given window size.",
      tags: ["Coding", "Technical Analysis", "Statistics"],
      starChecks: [
        "Correct rolling mean calculation",
        "Correct rolling standard deviation",
        "Proper band calculation (mean ± 2σ)",
        "Handles edge cases (window size, data length)",
      ],
    },
    {
      id: 3,
      prompt: "Maximum Drawdown: Given an array of portfolio values, calculate the maximum drawdown.",
      tags: ["Coding", "Risk Metrics", "Algorithm"],
      starChecks: [
        "Correct drawdown calculation (peak to trough)",
        "Efficient algorithm (O(n) time complexity)",
        "Handles edge cases (empty array, single value)",
        "Returns both max drawdown value and period",
      ],
    },
    {
      id: 4,
      prompt: "Sharpe Ratio Calculator: Implement a function to calculate annualized Sharpe ratio from daily returns.",
      tags: ["Coding", "Risk Metrics", "Statistics"],
      starChecks: [
        "Correct calculation: (mean return - risk-free) / (std dev × √252)",
        "Proper annualization (252 trading days)",
        "Handles risk-free rate parameter",
        "Edge case handling (zero variance, negative returns)",
      ],
    },
    {
      id: 5,
      prompt: "Pairs Trading Signal: Given two correlated stocks' prices, detect when the spread deviates >2 std devs.",
      tags: ["Coding", "Pairs Trading", "Statistics"],
      starChecks: [
        "Calculate spread (price1 - price2 or ratio)",
        "Calculate rolling mean and std dev of spread",
        "Detect when |spread - mean| > 2σ",
        "Return clear signals (buy/sell spread)",
      ],
    },
  ] as BehavioralQuestion[],
  'statistics-ml': [
    {
      id: 1,
      question: "Explain the Central Limit Theorem and its relevance to trading.",
      answer: "CLT states that sample means of independent observations converge to normal distribution. In trading: portfolio returns, strategy performance metrics, and risk estimates can be approximated as normal, enabling statistical inference and risk management.",
      explanation: [
        "CLT: Sum/average of i.i.d. random variables → normal distribution as n → ∞",
        "Trading relevance: Portfolio returns (sum of asset returns) approximate normal",
        "Enables: confidence intervals, hypothesis testing, VaR calculations",
        "Limitations: Assumes independence, may not hold for fat-tailed distributions",
      ],
      hint: "Think about how portfolio returns are sums of individual returns",
      difficulty: "medium",
      targetTime: 90,
    },
    {
      id: 2,
      question: "What's the difference between Type I and Type II errors in the context of a trading signal?",
      answer: "Type I (false positive): Signal says trade but shouldn't trade (lose money). Type II (false negative): Signal says don't trade but should trade (miss opportunity). In trading, Type I is often costlier.",
      explanation: [
        "Type I error (α): Reject null when true - false positive signal",
        "Type II error (β): Accept null when false - false negative (miss trade)",
        "Trading context: Type I = bad trades, Type II = missed good trades",
        "Power = 1 - β: probability of detecting true signal",
      ],
      hint: "Type I = false alarm, Type II = missed detection",
      difficulty: "medium",
      targetTime: 60,
    },
    {
      id: 3,
      question: "How do you test if two trading strategies have significantly different Sharpe ratios?",
      answer: "Use a statistical test like the Jobson-Korkie test or bootstrap method. Compare Sharpe ratios accounting for correlation between strategies. Null hypothesis: Sharpe ratios are equal.",
      explanation: [
        "Jobson-Korkie test: Tests equality of Sharpe ratios",
        "Accounts for correlation between strategy returns",
        "Bootstrap: Resample returns, calculate Sharpe distribution",
        "Alternative: Compare Sharpe ratios with confidence intervals",
      ],
      hint: "Need to account for correlation and distribution of Sharpe ratio",
      difficulty: "hard",
      targetTime: 90,
    },
    {
      id: 4,
      question: "Explain p-hacking and how it affects quantitative strategy development.",
      answer: "P-hacking is repeatedly testing hypotheses until finding significant results by chance. In quant: testing many factors/parameters until one shows significance inflates false discovery rate. Solutions: multiple testing correction, out-of-sample testing, hold-out data.",
      explanation: [
        "P-hacking: Multiple hypothesis testing without correction",
        "Problem: 5% significance level means 1 in 20 tests significant by chance",
        "In quant: Testing 100 factors → expect 5 significant by chance",
        "Solutions: Bonferroni correction, FDR control, out-of-sample validation",
      ],
      hint: "Multiple testing without correction inflates false positives",
      difficulty: "medium",
      targetTime: 75,
    },
    {
      id: 5,
      question: "What's heteroskedasticity and why does it matter in financial time series?",
      answer: "Heteroskedasticity is non-constant variance over time. In finance: volatility clustering (high vol follows high vol). Matters because: violates OLS assumptions, affects confidence intervals, requires GARCH/volatility models.",
      explanation: [
        "Heteroskedasticity: Variance changes over time",
        "Financial markets: Volatility clustering (ARCH/GARCH effects)",
        "Problems: Standard errors biased, inefficient estimates",
        "Solutions: GARCH models, robust standard errors, volatility weighting",
      ],
      hint: "Think about volatility clustering in markets",
      difficulty: "medium",
      targetTime: 75,
    },
  ] as MLQuestion[],
  'trading-intuition': [
    {
      id: 1,
      question: "Two highly correlated stocks diverge suddenly. What are potential causes and how would you trade it?",
      answer: "Causes: company-specific news, sector rotation, liquidity events, or correlation breakdown. Trade: pairs trade (long underperformer, short outperformer) expecting reversion, but check if divergence is fundamental vs temporary.",
      explanation: [
        "Potential causes: Fundamental change, temporary dislocation, liquidity",
        "Trading approach: Pairs trade if mean-reverting",
        "Risk: Divergence could be permanent (fundamental change)",
        "Check: News, volume, whether correlation breakdown is structural",
      ],
      hint: "Consider whether divergence is temporary or permanent",
      difficulty: "medium",
      targetTime: 90,
    },
    {
      id: 2,
      question: "Volatility is at historic lows. How should this affect your strategy selection and position sizing?",
      answer: "Low vol suggests: reduce position sizes (vol will normalize), favor mean reversion over momentum, increase hedging, prepare for vol spike. Low vol often precedes high vol periods.",
      explanation: [
        "Low vol environment: Volatility clustering suggests vol will rise",
        "Position sizing: Reduce sizes anticipating vol normalization",
        "Strategy: Mean reversion may work better than momentum",
        "Risk: Vol spikes can cause large losses if over-leveraged",
      ],
      hint: "Volatility tends to cluster and mean-revert",
      difficulty: "medium",
      targetTime: 75,
    },
    {
      id: 3,
      question: "You observe large volume without price movement. What might this indicate?",
      answer: "Possible causes: large block trade at midpoint, market maker inventory management, accumulation/distribution, or information asymmetry. Could signal upcoming move or institutional positioning.",
      explanation: [
        "High volume, low price change: Unusual activity",
        "Possible causes: Block trades, market making, accumulation",
        "Trading implication: May signal upcoming directional move",
        "Investigate: Who is trading, order flow, market microstructure",
      ],
      hint: "Think about what causes volume without price impact",
      difficulty: "medium",
      targetTime: 60,
    },
    {
      id: 4,
      question: "A stock's implied volatility is much higher than realized volatility. What trade does this suggest?",
      answer: "Sell volatility (short options, sell straddles/strangles). IV > RV means options are expensive relative to actual movement. Profit from vol crush if realized vol stays low.",
      explanation: [
        "IV > RV: Options are expensive relative to actual movement",
        "Trade: Sell volatility (short options, sell straddles)",
        "Profit from: Volatility crush, theta decay",
        "Risk: Large move could cause losses",
      ],
      hint: "When IV > RV, options are rich - sell them",
      difficulty: "medium",
      targetTime: 60,
    },
    {
      id: 5,
      question: "You notice your alpha factor worked well for 3 years but stopped working 6 months ago. What do you do?",
      answer: "Investigate: regime change, factor crowding, data issues, or overfitting. Check: out-of-sample performance, factor exposure changes, market regime. Consider: reducing allocation, modifying factor, or killing strategy if fundamental change.",
      explanation: [
        "Possible causes: Regime change, crowding, overfitting, data issues",
        "Investigation: Check regime, factor exposure, correlation breakdown",
        "Action: Reduce allocation, modify factor, or kill strategy",
        "Learning: Factor decay is normal, need continuous research",
      ],
      hint: "Factor decay is common - investigate cause before abandoning",
      difficulty: "medium",
      targetTime: 90,
    },
  ] as TradingQuestion[],
  'research-discussion': [
    {
      id: 1,
      prompt: "Walk me through your research process from idea generation to implementation.",
      tags: ["Research Process", "Methodology", "Implementation"],
      starChecks: [
        "Clear stages: idea → hypothesis → backtest → validation → implementation",
        "Specific tools and methods used",
        "How you validate ideas before implementation",
        "Risk management and monitoring process",
      ],
    },
    {
      id: 2,
      prompt: "Describe a research project that failed. What did you learn?",
      tags: ["Learning", "Failure", "Reflection"],
      starChecks: [
        "Specific failed project described",
        "Honest assessment of why it failed",
        "Key lessons learned",
        "How you applied learnings to future projects",
      ],
    },
    {
      id: 3,
      prompt: "How do you generate new trading ideas? What sources do you use?",
      tags: ["Idea Generation", "Research", "Sources"],
      starChecks: [
        "Multiple sources mentioned (papers, data, market observation)",
        "Systematic approach to idea generation",
        "How you prioritize and filter ideas",
        "Examples of successful ideas generated",
      ],
    },
    {
      id: 4,
      prompt: "Explain a recent paper you read that interested you and how it might apply to trading.",
      tags: ["Research", "Academic", "Application"],
      starChecks: [
        "Specific paper and key concepts explained",
        "Clear understanding of the research",
        "How it applies to trading",
        "Potential implementation approach",
      ],
    },
    {
      id: 5,
      prompt: "How do you balance complexity and interpretability in your models?",
      tags: ["Model Design", "Trade-offs", "Interpretability"],
      starChecks: [
        "Understanding of complexity vs interpretability trade-off",
        "Framework for making decisions",
        "Examples of when to use each approach",
        "How you communicate complex models",
      ],
    },
  ] as BehavioralQuestion[],
}

export const quantCategoryLabels: Record<string, string> = {
  'mental-calculations': 'Mental Calculations',
  'probability-exercises': 'Probability Exercises',
  'brainteasers': 'Brainteasers',
  'coding-project': 'Coding Project',
  'statistics-ml': 'Statistics & ML',
  'trading-intuition': 'Trading Intuition',
  'research-discussion': 'Research Discussion',
}

